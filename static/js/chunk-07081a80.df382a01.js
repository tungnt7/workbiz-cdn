(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07081a80"],{2083:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"}),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:0,staticStyle:{width:"100%"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{label:"Tên quyền","min-width":"80px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[n("span",[t._v(t._s(i.name))])]}}])}),n("el-table-column",{attrs:{label:"Mô tả","min-width":"80px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[n("span",[t._v(t._s(i.description))])]}}])}),n("el-table-column",{attrs:{label:"Cập nhật",align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleUpdate(i)}}},[t._v("Cập nhật")])]}}])})],1),n("el-dialog",{attrs:{title:"Cập nhật quyền",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.actionLoading,expression:"actionLoading"}],ref:"dataForm",staticClass:"agent-form",staticStyle:{width:"100%"},attrs:{model:t.temp,"label-position":"left","label-width":"140px",rules:t.rules}},[n("el-form-item",{attrs:{label:"Tên quyền",prop:"name"}},[n("el-input",{attrs:{disabled:!0},model:{value:t.temp.name,callback:function(e){t.$set(t.temp,"name",e)},expression:"temp.name"}})],1),n("el-form-item",{attrs:{label:"Mô tả",prop:""}},[n("el-input",{model:{value:t.temp.description,callback:function(e){t.$set(t.temp,"description",e)},expression:"temp.description"}})],1),n("el-form-item",{attrs:{label:"Danh sách quyền"}},[n("el-tree",{ref:"tree",staticClass:"permission-tree",attrs:{"check-strictly":t.checkStrictly,data:t.permissionList,props:t.defaultProps,"show-checkbox":"","default-expand-all":"","node-key":"name"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("ĐÓNG")]),n("el-button",{attrs:{type:"primary",loading:t.actionLoading},on:{click:function(e){return t.updateData()}}},[t._v("Cập nhật")])],1)],1)],1)},a=[],o=n("5530"),r=(n("d81d"),n("b0c0"),n("4de4"),n("c740"),n("a434"),n("cc5e")),s=n("b775"),l="/permission",c=function(){return Object(s["a"])({url:l,method:"GET"})},d={data:function(){return{list:[],permissionList:[],listLoading:!1,actionLoading:!1,dialogFormVisible:!1,checkStrictly:!1,defaultProps:{children:"permissions",label:"description"},temp:{role_id:null,name:"",description:"",permissions:[]},rules:{name:[{required:!0,message:"Chưa nhập tên nhóm quyền",trigger:"change"}]}}},created:function(){this.fetchPermission(),this.fetchList()},methods:{fetchList:function(){var t=this;this.listLoading=!0,Object(r["b"])().then((function(e){t.list=e.data,t.listLoading=!1}))},fetchPermission:function(){var t=this;c().then((function(e){t.permissionList=e.data}))},handleUpdate:function(t){var e=this;this.actionLoading=!0,this.dialogFormVisible=!0,Object(r["a"])(t.role_id).then((function(t){var n=t.data.permissions,i=n.map((function(t){return t.name}));e.temp=t.data,e.$nextTick((function(){e.$refs.tree.setCheckedKeys(i),e.$refs["dataForm"].clearValidate(),e.actionLoading=!1}))})).catch((function(t){console.log(t),e.actionLoading=!1}))},updateData:function(){var t=this;this.$refs["dataForm"].validate((function(e){if(e){t.actionLoading=!0;var n=t.$refs.tree.getCheckedKeys().filter((function(t){return t})),i=Object(o["a"])(Object(o["a"])({},t.temp),{permissions:n});Object(r["e"])(i.role_id,i).then((function(){var e=t.list.findIndex((function(e){return e.role_id===t.temp.role_id}));t.list.splice(e,1,t.temp),t.dialogFormVisible=!1,t.$notify({title:"Thành công",message:"Cập nhật thông tin bộ phận thành công!",type:"success",duration:2e3}),t.actionLoading=!1}))}}))}}},u=d,p=n("2877"),m=Object(p["a"])(u,i,a,!1,null,null,null);e["default"]=m.exports},cc5e:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return l})),n.d(e,"d",(function(){return c}));var i=n("b775"),a="/role";function o(){return Object(i["a"])({url:a,method:"get"})}function r(){return Object(i["a"])({url:a+"/share-list",method:"get"})}function s(t,e){return Object(i["a"])({url:"".concat(a,"/").concat(t,"/update"),method:"post",data:e})}function l(t){return Object(i["a"])({url:"".concat(a,"/").concat(t,"/detail"),method:"GET"})}function c(){return Object(i["a"])({url:a+"/users-by-admin",method:"get"})}}}]);