(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cfed4878"],{"1c18":function(e,t,n){},3037:function(e,t,n){},"333d":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[n("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},r=[];n("a9e3");Math.easeInOutQuad=function(e,t,n,a){return e/=a/2,e<1?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function s(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(e,t,n){var a=o(),r=e-a,l=20,u=0;t="undefined"===typeof t?500:t;var c=function e(){u+=l;var o=Math.easeInOutQuad(u,a,r,t);s(o),u<t?i(e):n&&"function"===typeof n&&n()};c()}var u={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&l(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&l(0,800)}}},c=u,d=(n("e498"),n("2877")),p=Object(d["a"])(c,a,r,!1,null,"6af373ef",null);t["a"]=p.exports},cc5e:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u}));var a=n("b775"),r="/role";function i(){return Object(a["a"])({url:r,method:"get"})}function s(){return Object(a["a"])({url:r+"/share-list",method:"get"})}function o(e,t){return Object(a["a"])({url:"".concat(r,"/").concat(e,"/update"),method:"post",data:t})}function l(e){return Object(a["a"])({url:"".concat(r,"/").concat(e,"/detail"),method:"GET"})}function u(){return Object(a["a"])({url:r+"/users-by-admin",method:"get"})}},dd61:function(e,t,n){"use strict";n("3037")},e382:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"page-header"},[n("el-row",[n("el-col",{attrs:{span:24}},[n("h3",{staticClass:"page-title"},[e._v("Quản lý nhân viên")])])],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Tìm kiếm theo họ tên, email, số điện thoại",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.search_keyword,callback:function(t){e.$set(e.listQuery,"search_keyword",t)},expression:"listQuery.search_keyword"}}),n("el-select",{staticStyle:{"margin-left":"10px"},attrs:{clearable:"",placeholder:"Quyền hạn"},on:{change:e.getList},model:{value:e.listQuery.role,callback:function(t){e.$set(e.listQuery,"role",t)},expression:"listQuery.role"}},e._l(e.listRoleFilter,(function(e){return n("el-option",{key:"role-"+e.role_id,attrs:{label:e.description,value:e.name}})})),1),n("el-select",{staticStyle:{"margin-left":"10px"},attrs:{clearable:"",placeholder:"Bộ phận"},on:{change:e.getList},model:{value:e.listQuery.user_group_id,callback:function(t){e.$set(e.listQuery,"user_group_id",t)},expression:"listQuery.user_group_id"}},e._l(e.listUserGroupFilter,(function(e){return n("el-option",{key:"user-group-"+(e.user_group||(Math.random()+1).toString(36).substring(7)),attrs:{label:e.name,value:e.user_group_id}})})),1)],1),n("el-col",{staticClass:"text-right",attrs:{span:12}},[e.isPermission(e.permissions.create)?n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handleClickShowDialog(null)}}},[e._v("Thêm mới")]):e._e()],1)],1)],1),n("div",{staticClass:"page-content"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center",label:"ID","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.user_id))])]}}])}),n("el-table-column",{attrs:{"min-width":"180px",align:"center",label:"Họ tên"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.name))])]}}])}),n("el-table-column",{attrs:{"min-width":"180px",align:"center",label:"Email"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.email))])]}}])}),n("el-table-column",{attrs:{"class-name":"status-col",label:"Số điện thoại","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(e._s(a.phone_number||"Chưa cài đặt"))])]}}])}),n("el-table-column",{attrs:{"min-width":"180px",align:"center",label:"Bộ phận"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(e._s(a.user_group_name))])]}}])}),n("el-table-column",{attrs:{"min-width":"180px",align:"center",label:"Quyền hạn"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(e._s(a.role_description))])]}}])}),n("el-table-column",{attrs:{"min-width":"120px",align:"center",label:"Trạng thái"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[n("el-switch",{attrs:{disabled:!e.isPermission(e.permissions.edit)},on:{change:function(t){return e.handleChangeUserStatus(a.user_id,a.status)}},model:{value:a.status,callback:function(t){e.$set(a,"status",t)},expression:"row.status"}})],1)]}}])}),e.isPermission(e.permissions.edit)?n("el-table-column",{attrs:{align:"center",label:"Actions","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(t){return e.handleClickShowDialog(a.user_id)}}},[e._v("Cập nhật")])]}}],null,!1,3372789038)}):e._e()],1),n("user-form",{ref:"user_form",attrs:{"user-id":e.selectedId,roles:e.listRoleFilter},on:{reloadList:e.getList,updated:e.userUpdated}}),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}})],1)])},r=[],i=n("c24f"),s=n("cc5e"),o=n("333d"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,width:"500px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",staticClass:"user-form",staticStyle:{width:"100%"},attrs:{model:e.userData,"label-position":"top","label-width":"140px",rules:e.rules,size:"small"}},[n("el-form-item",{attrs:{label:"Tên chuyên viên",prop:"name"}},[n("el-input",{model:{value:e.userData.name,callback:function(t){e.$set(e.userData,"name",t)},expression:"userData.name"}})],1),n("el-form-item",{attrs:{label:"Email",prop:"email"}},[n("el-input",{attrs:{disabled:"update"==e.dialogStatus},model:{value:e.userData.email,callback:function(t){e.$set(e.userData,"email",t)},expression:"userData.email"}})],1),n("el-form-item",{attrs:{label:"Số điện thoại",prop:"phone_number"}},[n("el-input",{model:{value:e.userData.phone_number,callback:function(t){e.$set(e.userData,"phone_number",t)},expression:"userData.phone_number"}})],1),n("el-form-item",{style:"margin-bottom: "+e.passwordBottom+"rem !important",attrs:{label:"Mật khẩu "+("update"==e.dialogStatus?"(Để trống sẽ giữ nguyên mật khẩu cũ)":"")+" ",prop:"password"}},[n("el-input",{model:{value:e.userData.password,callback:function(t){e.$set(e.userData,"password",t)},expression:"userData.password"}},[n("i",{staticClass:"el-icon-refresh-left cursor-pointer",attrs:{slot:"suffix"},on:{click:e.generatePassword},slot:"suffix"})])],1),n("el-form-item",{attrs:{label:"Quyền hạn",prop:"role_id"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:e.userData.role_id,callback:function(t){e.$set(e.userData,"role_id",t)},expression:"userData.role_id"}},e._l(e.roles,(function(e){return n("el-option",{key:"user-form-role-"+e.role_id,attrs:{label:e.description,value:e.role_id}})})),1)],1),n("el-form-item",{attrs:{label:"Bộ phận",prop:"user_group_id"}},[n("el-select",{staticStyle:{width:"100%"},model:{value:e.userData.user_group_id,callback:function(t){e.$set(e.userData,"user_group_id",t)},expression:"userData.user_group_id"}},e._l(e.userGroups,(function(e){return n("el-option",{key:"user-group-"+(e.user_group_id||(Math.random()+1).toString(36).substring(7)),attrs:{label:e.name,value:e.user_group_id}})})),1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("ĐÓNG")]),n("el-button",{attrs:{type:"primary",loading:e.loadingBtn},on:{click:function(t){return e.handleCreateOrUpdateUser()}}},[e._v(e._s("create"==e.dialogStatus?"Thêm mới":"Cập nhật"))])],1)],1)},u=[],c=(n("a9e3"),n("d3b7"),n("a15b"),n("4e82"),n("ac1f"),n("1276"),n("61f7")),d=n("fa8d"),p={props:{userId:{type:Number,default:0},roles:{type:Array,default:null}},data:function(){var e=this,t=function(e,t,n){return t?Object(c["d"])(t)?void n():n(new Error("Email không đúng định dạng")):n(new Error("Email không được để trống"))},n=function(t,n,a){if(e.passwordBottom=0,n&&!Object(c["e"])(n))return e.passwordBottom=2,a(new Error("Mật khẩu có độ dài 8 - 16 ký tự bao gồm ít nhất một chữ hoa, một chữ thường, một chữ số  và một ký tự đặc biệt"));a()},a=function(e,t,n){return t?Object(c["f"])(t)?void n():n(new Error("Số điện thoại không đúng định dạng")):n(new Error("Số điện thoại không được để trống"))};return{dialogStatus:"create",dialogFormVisible:!1,loading:!1,loadingBtn:!1,userGroups:[],passwordBottom:0,textMap:{update:"Chỉnh sửa nhân viên",create:"Tạo mới nhân viên"},userData:{name:"",email:"",username:"",password:"",role_id:"",phone_number:""},rules:{name:[{required:!0,message:"Chưa nhập họ tên",trigger:"change"}],email:[{validator:t,trigger:"change"}],password:[{validator:n,trigger:"change"}],role_id:[{required:!0,message:"Chưa chọn quyền hạn",trigger:"change"}],phone_number:[{validator:a,trigger:"change"}]}}},watch:{userId:function(e,t){e?(this.dialogStatus="update",this.rules.password=[],this.getUser()):(this.resetUserData(),this.dialogStatus="create")}},created:function(){this.getShareUserGroupList()},methods:{showDialog:function(){this.dialogFormVisible=!0},hideDialog:function(){this.dialogFormVisible=!1},resetUserData:function(){this.userData={name:"",email:"",username:"",password:"",role_id:"",phone_number:""}},getUser:function(){var e=this,t=this.userId;t&&(this.loading=!0,Object(i["i"])(t).then((function(t){var n=t.data;n.password="",e.userData=n})).finally((function(){e.loading=!1})))},getShareUserGroupList:function(){var e=this;Object(d["b"])().then((function(t){e.userGroups=t.data}))},resetForm:function(){this.hideDialog(),this.resetUserData(),this.loadingBtn=!1,this.$refs["dataForm"]&&this.$refs["dataForm"].resetFields(),this.$emit("reloadList")},handleCreateOrUpdateUser:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){e.loadingBtn=!0;var n=e.userId,a=e.userData;e.userData.username=e.userData.email,n?Object(i["q"])(n,a).then((function(t){e.loading=!1,e.$message({type:"success",message:"Thành công"})})).finally((function(){e.$emit("updated"),e.resetForm()})):Object(i["b"])(a).then((function(t){e.loading=!1,e.$message({type:"success",message:"Thành công"}),e.$store.dispatch("share/setUsers")})).finally((function(){e.resetForm()}))}}))},generatePassword:function(){var e=this.getRandomInt(8,16),t="abcdefghijklmnopqrstuvwxyz",n="0123456789",a="!@#$%^&*()_+~`|}{[]:;?><,./-=",r="",i="";while(r.length<e){var s=Math.ceil(t.length*Math.random()*Math.random()),o=Math.ceil(n.length*Math.random()*Math.random()),l=Math.ceil(a.length*Math.random()*Math.random()),u=t.charAt(s);u=r.length%2===0?u.toUpperCase():u,i+=u,i+=n.charAt(o),i+=a.charAt(l),r=i}r=r.split("").sort((function(){return.5-Math.random()})).join(""),this.userData.password=r.substr(0,e)},getRandomInt:function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}}},h=p,m=n("2877"),g=Object(m["a"])(h,l,u,!1,null,null,null),f=g.exports,b=n("ee2e"),_={name:"UserList",components:{Pagination:o["a"],userForm:f},data:function(){return{list:null,listRoleFilter:[],total:0,listLoading:!0,listQuery:{page:1,limit:20,search_keyword:"",role:""},selectedId:null,permissions:{create:b["b"],edit:b["c"]}}},computed:{listUserGroupFilter:function(){return this.$store.getters.user_groups}},created:function(){this.getList(),this.getShareListRole()},methods:{getList:function(){var e=this;this.listLoading=!0,Object(i["j"])(this.listQuery).then((function(t){e.list=t.data.data,e.total=t.data.total,e.listLoading=!1}))},handleClickShowDialog:function(e){this.selectedId=e,this.$refs.user_form.showDialog()},getShareListRole:function(){var e=this;Object(s["c"])().then((function(t){var n=t.data;e.listRoleFilter=n}))},handleChangeUserStatus:function(e,t){var n=this;console.log(e,t);var a={status:t};Object(i["q"])(e,a).then((function(e){n.$message({type:"success",message:"Thành công"})}))},userUpdated:function(){this.selectedId=null}}},v=_,y=(n("dd61"),Object(m["a"])(v,a,r,!1,null,"0bb628d4",null));t["default"]=y.exports},e498:function(e,t,n){"use strict";n("1c18")},ee2e:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i}));var a="PROJECT_REPORT",r="USER_CREATE",i="USER_EDIT"},fa8d:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return u}));var a=n("b775"),r="/user-group";function i(e){return Object(a["a"])({url:r,method:"get",params:e})}function s(e){return Object(a["a"])({url:r+"/share",method:"get",params:e})}function o(e){return Object(a["a"])({url:r+"/"+e,method:"get"})}function l(e,t){return Object(a["a"])({url:r+"/"+e+"/update",method:"post",data:t})}function u(e){return Object(a["a"])({url:r,method:"post",data:e})}}}]);